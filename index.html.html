<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è·è­·å·¥ä½œæ—¥èªŒ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body { 
            font-family: 'Microsoft JhengHei', sans-serif; 
            background: var(--primary-sage);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .hidden { 
            display: none !important; 
        }
        
        :root {
            --primary-sage: #D6DCDB;      /* 141 - ä¸»è¦èƒŒæ™¯è‰² */
            --secondary-mint: #C6CCC0;     /* 146 - æ¬¡è¦èƒŒæ™¯è‰² */
            --neutral-grey: #82898D;       /* 142 - ä¸­æ€§ç°è‰² */
            --warm-peach: #E1AA8D;         /* 147 - æº«æš–æ¡ƒè‰² */
            --soft-brown: #C0B0A2;         /* 143 - æŸ”å’Œæ£•è‰² */
            --light-cream: #F2EEED;        /* 148 - æ·ºå¥¶æ²¹è‰² */
            --deep-brown: #8D6B61;         /* 144 - æ·±æ£•è‰² */
            --cool-sage: #A1B0AD;          /* 149 - å†·èª¿é¼ å°¾è‰ */
            --pale-blue: #E3E7EA;          /* 145 - æ·¡è—è‰² */
            --dusty-rose: #C39289;         /* 150 - å¡µç«ç‘°è‰² */
            
            /* æ–°å¢æ·ºè‰²æŒ‰éˆ•é¡è‰² */
            --button-dark: #A1B0AD;        /* æ·ºè‰²æŒ‰éˆ•ä¸»è‰² */
            --button-dark-hover: #8D9B98;  /* æ·ºè‰²æŒ‰éˆ•æ‡¸åœè‰² */
        }

        .card {
            background: #f8f9fa;
            backdrop-filter: blur(10px);
            border: 1px solid #e9ecef;
            box-shadow: 0 8px 32px rgba(141, 107, 97, 0.15);
            border-radius: 1rem;
            padding: 2.5rem;
            margin-bottom: 3rem;
        }

        /* çµ±ä¸€æŒ‰éˆ•æ¨£å¼ - ä½¿ç”¨æ·ºè‰²æŒ‰éˆ•ï¼ŒåŒ…å«å‚™ä»½æŒ‰éˆ•å’Œæ€¥æ•‘ç®±æŒ‰éˆ• */
        .btn-primary,
        .btn-success,
        .btn-todo,
        .btn-stats,
        .btn-change,
        .btn-template,
        .btn-backup,
        .btn-supplies {
            background: var(--button-dark);
            border: none;
            color: var(--deep-brown);
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            font-size: 1.125rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            box-shadow: 0 4px 12px rgba(161, 176, 173, 0.3);
            width: 100%;
        }

        .btn-primary:hover,
        .btn-success:hover,
        .btn-todo:hover,
        .btn-stats:hover,
        .btn-change:hover,
        .btn-template:hover,
        .btn-backup:hover,
        .btn-supplies:hover {
            background: var(--button-dark-hover);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(141, 155, 152, 0.4);
        }

        .btn-cancel {
            background: var(--neutral-grey);
            border: none;
            color: var(--light-cream);
            padding: 1rem 2.5rem;
            border-radius: 0.75rem;
            font-size: 1.125rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(130, 137, 141, 0.2);
        }

        .btn-cancel:hover {
            background: var(--deep-brown);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(130, 137, 141, 0.3);
        }

        .form-input {
            border: 2px solid var(--secondary-mint);
            transition: all 0.3s ease;
            background: var(--light-cream);
            border-radius: 0.75rem;
            padding: 1rem 1.25rem;
            font-size: 1.125rem;
            width: 100%;
            color: var(--deep-brown);
        }

        .form-input:focus {
            border-color: var(--dusty-rose);
            box-shadow: 0 0 0 3px rgba(195, 146, 137, 0.15);
            background: rgba(242, 238, 237, 0.98);
            outline: none;
        }

        .header-gradient {
            color: var(--deep-brown);
            text-align: center;
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .section-header {
            color: var(--deep-brown);
            border-bottom: 2px solid var(--neutral-grey);
            padding-bottom: 0.5rem;
            font-size: 1.875rem;
            font-weight: bold;
            margin-bottom: 2rem;
        }

        .entry-card {
            background: var(--light-cream);
            border: 1px solid var(--neutral-grey);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(141, 107, 97, 0.1);
        }

        .entry-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(141, 107, 97, 0.15);
            border-color: var(--neutral-grey);
        }

        .change-card {
            background: var(--light-cream);
            border: 1px solid var(--neutral-grey);
            border-left: 4px solid var(--neutral-grey);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(195, 146, 137, 0.1);
        }

        .change-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(195, 146, 137, 0.15);
        }

        .change-type-badge {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .change-type-new {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
        }

        .change-type-modify {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
        }

        .change-type-remove {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }

        .tag {
            background: var(--pale-blue);
            color: var(--deep-brown);
            border: 1px solid var(--primary-sage);
            border-radius: 0.75rem;
            padding: 1rem;
        }

        .search-container {
            background: rgba(242, 238, 237, 0.9);
            border: 1px solid var(--neutral-grey);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 3rem;
            box-shadow: 0 4px 16px rgba(141, 107, 97, 0.1);
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-content {
            background: var(--light-cream);
            border-radius: 1rem;
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(141, 107, 97, 0.3);
            border: 1px solid var(--neutral-grey);
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--deep-brown);
            margin-bottom: 1rem;
        }

        .modal-message {
            font-size: 1.125rem;
            color: var(--neutral-grey);
            margin-bottom: 2rem;
            line-height: 1.5;
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        .modal-btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-btn-confirm {
            background: var(--dusty-rose);
            color: var(--light-cream);
        }

        .modal-btn-confirm:hover {
            background: var(--warm-peach);
            color: var(--deep-brown);
        }

        .modal-btn-cancel {
            background: var(--secondary-mint);
            color: var(--deep-brown);
        }

        .modal-btn-cancel:hover {
            background: var(--primary-sage);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--deep-brown);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: var(--dusty-rose);
            color: var(--light-cream);
        }

        .icon-btn {
            transition: all 0.3s ease;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            cursor: pointer;
            font-size: 1rem;
        }

        .icon-btn:hover {
            transform: scale(1.1);
        }

        .edit-btn {
            background: var(--cool-sage);
            color: var(--deep-brown);
        }

        .delete-btn {
            background: var(--dusty-rose);
            color: var(--light-cream);
            font-weight: bold;
            border: 2px solid var(--warm-peach);
        }

        .delete-btn:hover {
            background: var(--soft-brown);
            color: var(--light-cream);
            transform: scale(1.15);
            box-shadow: 0 4px 12px rgba(192, 176, 162, 0.5);
        }

        .template-section {
            background: var(--pale-blue);
            border: 1px solid var(--primary-sage);
            border-radius: 0.75rem;
            padding: 1rem;
            margin-bottom: 1rem;
            opacity: 0.6;
        }

        .template-btn {
            background: var(--pale-blue);
            color: var(--deep-brown);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 0.9rem;
            margin: 0.25rem;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .template-btn:hover {
            background: var(--dusty-rose);
            color: var(--light-cream);
        }

        .tag-input-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            align-items: center;
            border: 2px solid var(--secondary-mint);
            border-radius: 0.75rem;
            padding: 0.5rem;
            background: var(--light-cream);
        }

        .tag-input-container:focus-within {
            border-color: var(--dusty-rose);
            box-shadow: 0 0 0 3px rgba(195, 146, 137, 0.15);
        }

        .tag-item {
            background: var(--dusty-rose);
            color: var(--light-cream);
            padding: 0.25rem 0.5rem;
            border-radius: 0.5rem;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            font-weight: 500;
        }

        .tag-remove {
            background: none;
            border: none;
            color: var(--light-cream);
            cursor: pointer;
            font-size: 0.8rem;
            padding: 0;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .tag-remove:hover {
            background: rgba(242, 238, 237, 0.3);
        }

        .tag-input {
            border: none;
            outline: none;
            background: none;
            flex: 1;
            min-width: 100px;
            font-size: 1rem;
            color: var(--deep-brown);
        }

        .tab-container {
            display: flex;
            border-bottom: 2px solid var(--neutral-grey);
            margin-bottom: 2rem;
        }

        .tab-btn {
            background: none;
            border: none;
            padding: 1rem 1.5rem;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            color: var(--deep-brown);
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            color: var(--neutral-grey);
            border-bottom-color: var(--neutral-grey);
            background: var(--pale-blue);
            opacity: 0.8;
        }

        .tab-btn:hover {
            background: var(--pale-blue);
            opacity: 0.5;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .flex { display: flex; }
        .flex-wrap { flex-wrap: wrap; }
        .items-center { align-items: center; }
        .justify-center { justify-content: center; }
        .gap-6 { gap: 1.5rem; }
        .gap-4 { gap: 1rem; }
        .gap-2 { gap: 0.5rem; }
        .mb-12 { margin-bottom: 3rem; }
        .mb-8 { margin-bottom: 2rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 0.75rem; }
        .mt-6 { margin-top: 1.5rem; }
        .grid { display: grid; }
        .grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
        .col-span-2 { grid-column: span 2; }
        .space-y-8 > * + * { margin-top: 2rem; }
        .text-center { text-align: center; }
        .relative { position: relative; }
        .absolute { position: absolute; }
        .left-5 { left: 1.25rem; }
        .top-1/2 { top: 50%; }
        .transform { transform: translateY(-50%); }
        .w-full { width: 100%; }
        .text-2xl { font-size: 1.5rem; }
        .text-xl { font-size: 1.25rem; }
        .text-lg { font-size: 1.125rem; }
        .font-bold { font-weight: bold; }
        .font-semibold { font-weight: 600; }
        .pl-14 { padding-left: 3.5rem; }
        .pr-6 { padding-right: 1.5rem; }
        .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
        .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
        .pt-8 { padding-top: 2rem; }

        @media (max-width: 768px) {
            .grid-cols-2 { grid-template-columns: 1fr; }
            .container { padding: 1rem; }
            .form-input { font-size: 1rem; }
        }

        /* ä¿®å¾©è€—æåˆªé™¤æŒ‰éˆ•æ¨£å¼ */
        .supply-delete-btn {
            background: #e74c3c !important;
            color: white !important;
            border: none !important;
            padding: 0.4rem 0.6rem !important;
            border-radius: 0.25rem !important;
            cursor: pointer !important;
            font-size: 0.8rem !important;
            transition: all 0.3s ease !important;
        }

        .supply-delete-btn:hover {
            background: #c0392b !important;
            transform: scale(1.05) !important;
        }

        .supply-edit-btn {
            background: var(--cool-sage) !important;
            color: var(--deep-brown) !important;
            border: none !important;
            padding: 0.4rem 0.6rem !important;
            border-radius: 0.25rem !important;
            cursor: pointer !important;
            font-size: 0.8rem !important;
            transition: all 0.3s ease !important;
        }

        .supply-edit-btn:hover {
            background: #8D9B98 !important;
        }

        .update-delete-btn {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="mb-12 text-center">
            <h1 class="header-gradient">è·è­·å·¥ä½œæ—¥èªŒ</h1>
            <p class="text-xl" style="color: var(--deep-brown)">è¨˜éŒ„æ¯æ—¥å·¥ä½œå…§å®¹ã€é‡è¦äº‹é …èˆ‡å·¥ä½œè®Šæ›´</p>
            <div class="mt-6" style="width: 8rem; height: 0.25rem; margin: 1.5rem auto; background: var(--neutral-grey); border-radius: 2px;"></div>
        </div>

        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 1rem; margin-bottom: 3rem; max-width: 1000px; margin-left: auto; margin-right: auto;">
            <button onclick="showAddForm()" class="btn-primary" style="width: 100%;">
                <span style="font-size: 1.2rem;">ğŸ“</span> æ–°å¢æ—¥èªŒ
            </button>
            <button onclick="showChangeForm()" class="btn-change" style="width: 100%;">
                <span style="font-size: 1.2rem;">ğŸ”„</span> å·¥ä½œè®Šæ›´
            </button>
            <button onclick="showSuppliesModal()" class="btn-supplies" style="width: 100%;">
                <span style="font-size: 1.2rem;">ğŸ¥</span> æ€¥æ•‘ç®±è€—æ
            </button>
            <button onclick="exportData()" class="btn-success" style="width: 100%;">
                <span style="font-size: 1.2rem;">ğŸ“¤</span> åŒ¯å‡º
            </button>
            <button onclick="showImportModal()" class="btn-success" style="width: 100%;">
                <span style="font-size: 1.2rem;">ğŸ“¥</span> åŒ¯å…¥
            </button>
            <button onclick="showTodoModal()" class="btn-todo" style="width: 100%;">
                <span style="font-size: 1.2rem;">â˜</span> å¾…è¾¦
            </button>
            <button onclick="showStatsModal()" class="btn-stats" style="width: 100%;">
                <span style="font-size: 1.2rem;">ğŸ“Š</span> çµ±è¨ˆ
            </button>
            <button onclick="showBackupSettings()" class="btn-backup">
                <span style="font-size: 1.2rem;">ğŸ’¾</span> å‚™ä»½
            </button>
        </div>

        <div class="search-container">
            <div class="flex flex-wrap gap-6">
                <div style="flex: 1; min-width: 20rem;">
                    <div class="relative">
                        <span class="absolute left-5 top-1/2 transform" style="color: var(--deep-brown); font-size: 1.5rem;">ğŸ”</span>
                        <input type="text" id="searchInput" placeholder="æœå°‹å…§å®¹..." oninput="filterContent()" class="form-input pl-14 pr-6" />
                    </div>
                </div>
                <div class="flex items-center gap-4">
                    <span style="color: var(--deep-brown); font-size: 1.5rem;">ğŸ“‹</span>
                    <select id="displayFilter" onchange="filterContent()" class="form-input px-6 py-4" style="width: auto; min-width: 160px;">
                        <option value="recent5">æœ€è¿‘5ç­†</option>
                        <option value="recent10">æœ€è¿‘10ç­†</option>
                        <option value="recent20">æœ€è¿‘20ç­†</option>
                        <option value="all">å…¨éƒ¨é¡¯ç¤º</option>
                        <option value="thisMonth">æœ¬æœˆ</option>
                        <option value="lastMonth">ä¸Šæœˆ</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- æ–°å¢æ—¥èªŒè¡¨å–® -->
        <div id="formContainer" class="hidden card">
            <h2 id="formTitle" class="section-header">æ–°å¢æ—¥èªŒ</h2>
            <div class="space-y-8">
                <div class="template-section">
                    <label class="block text-sm font-semibold mb-2" style="color: var(--deep-brown)">ğŸš€ å¿«é€Ÿç¯„æœ¬</label>
                    <div style="margin-bottom: 1rem;">
                        <button type="button" class="template-btn" onclick="insertTemplate('routine')" id="routineBtn">ä¾‹è¡Œå·¥ä½œ</button>
                        <button type="button" class="template-btn" onclick="insertTemplate('meeting')" id="meetingBtn">æœƒè­°è¨˜éŒ„</button>
                        <button type="button" class="template-btn" onclick="insertTemplate('emergency')" id="emergencyBtn">ç·Šæ€¥äº‹ä»¶</button>
                        <button type="button" class="template-btn" onclick="insertTemplate('health')" id="healthBtn">å¥åº·ä¿ƒé€²</button>
                        <button type="button" class="template-btn" onclick="insertTemplate('training')" id="trainingBtn">æ•™è‚²è¨“ç·´</button>
                    </div>
                    <div style="text-align: right;">
                        <button type="button" onclick="showTemplateEditor()" style="background: var(--dusty-rose); color: var(--light-cream); border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer; font-size: 0.85rem; font-weight: 500;">
                            âš™ï¸ ç·¨è¼¯ç¯„æœ¬
                        </button>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-6 mb-8">
                    <div>
                        <label class="block text-lg font-semibold mb-3" style="color: var(--deep-brown)">ğŸ“… æ—¥æœŸ</label>
                        <input type="date" id="date" class="form-input" />
                    </div>
                    <div>
                        <label class="block text-lg font-semibold mb-3" style="color: var(--deep-brown)">ğŸ·ï¸ æ¨™ç±¤</label>
                        <div class="tag-input-container" id="tagContainer">
                            <input type="text" class="tag-input" id="tagInput" placeholder="è¼¸å…¥æ¨™ç±¤å¾ŒæŒ‰Enter..." onkeypress="handleTagInput(event)">
                        </div>
                    </div>
                </div>

                <div>
                    <label class="block text-lg font-semibold mb-3" style="color: var(--deep-brown)">âš¡ ä¸»è¦å·¥ä½œå…§å®¹</label>
                    <textarea id="mainTasks" rows="5" class="form-input" placeholder="è¨˜éŒ„ä»Šæ—¥ä¸»è¦å®Œæˆçš„å·¥ä½œ..."></textarea>
                </div>

                <div class="grid grid-cols-2 gap-6">
                    <div>
                        <label class="block text-lg font-semibold mb-3" style="color: var(--deep-brown)">ğŸ‘¨â€ğŸ’¼ ä¸»ç®¡æŒ‡ç¤ºäº‹é …</label>
                        <textarea id="managementDirectives" rows="4" class="form-input" placeholder="è¨˜éŒ„ä¸»ç®¡äº¤è¾¦çš„äº‹é …..."></textarea>
                    </div>
                    <div>
                        <label class="block text-lg font-semibold mb-3" style="color: var(--deep-brown)">ğŸš¨ ç·Šæ€¥äº‹ä»¶è™•ç†</label>
                        <textarea id="emergencyEvents" rows="4" class="form-input" placeholder="è¨˜éŒ„ç·Šæ€¥äº‹ä»¶çš„è™•ç†éç¨‹..."></textarea>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-6">
                    <div>
                        <label class="block text-lg font-semibold mb-3" style="color: var(--deep-brown)">ğŸ’ª å¥åº·ä¿ƒé€²æ´»å‹•</label>
                        <textarea id="healthPromotionActivities" rows="4" class="form-input" placeholder="è¨˜éŒ„å¥åº·ä¿ƒé€²ç›¸é—œæ´»å‹•..."></textarea>
                    </div>
                    <div>
                        <label class="block text-lg font-semibold mb-3" style="color: var(--deep-brown)">ğŸ“ å…¶ä»–å‚™è¨»</label>
                        <textarea id="notes" rows="4" class="form-input" placeholder="å…¶ä»–éœ€è¦è¨˜éŒ„çš„äº‹é …..."></textarea>
                    </div>
                </div>
                
                <div class="flex gap-6 pt-8">
                    <button onclick="saveEntry()" class="btn-primary">ğŸ’¾ å„²å­˜æ—¥èªŒ</button>
                    <button onclick="cancelForm()" class="btn-cancel">âœ–ï¸ å–æ¶ˆ</button>
                </div>
            </div>
        </div>

        <!-- å·¥ä½œè®Šæ›´è¡¨å–® -->
        <div id="changeFormContainer" class="hidden card">
            <h2 id="changeFormTitle" class="section-header" style="color: #DCC677; border-bottom-color: #DCC677;">æ–°å¢å·¥ä½œè®Šæ›´è¨˜éŒ„</h2>
            <div class="space-y-8">
                <div class="grid grid-cols-2 gap-6 mb-8">
                    <div>
                        <label class="block text-lg font-semibold mb-3" style="color: #DCC677">ğŸ“… è®Šæ›´æ—¥æœŸ</label>
                        <input type="date" id="changeDate" class="form-input" />
                    </div>
                    <div>
                        <label class="block text-lg font-semibold mb-3" style="color: #DCC677">ğŸ”„ è®Šæ›´é¡å‹</label>
                        <select id="changeType" class="form-input">
                            <option value="new">æ–°å¢å·¥ä½œé …ç›®</option>
                            <option value="modify">ä¿®æ”¹å·¥ä½œå…§å®¹</option>
                            <option value="remove">ç§»é™¤å·¥ä½œé …ç›®</option>
                        </select>
                    </div>
                </div>

                <div>
                    <label class="block text-lg font-semibold mb-3" style="color: #DCC677">ğŸ“‹ å·¥ä½œé …ç›®åç¨±</label>
                    <input type="text" id="workItem" class="form-input" placeholder="ä¾‹å¦‚ï¼šæœƒè­°å®¤å®‰å…¨å·¡æª¢ã€å¥åº·æª¢æŸ¥æµç¨‹ã€é†«ç™‚ç”¨å“ç®¡ç†..." />
                </div>

                <div class="grid grid-cols-2 gap-6">
                    <div>
                        <label class="block text-lg font-semibold mb-3" style="color: #DCC677">ğŸ“ åŸæœ¬å…§å®¹</label>
                        <textarea id="originalContent" rows="4" class="form-input" placeholder="è¨˜éŒ„åŸæœ¬çš„å·¥ä½œå…§å®¹æˆ–åŸ·è¡Œé »ç‡..."></textarea>
                    </div>
                    <div>
                        <label class="block text-lg font-semibold mb-3" style="color: #DCC677">ğŸ†• è®Šæ›´å¾Œå…§å®¹</label>
                        <textarea id="newContent" rows="4" class="form-input" placeholder="è¨˜éŒ„è®Šæ›´å¾Œçš„å·¥ä½œå…§å®¹æˆ–åŸ·è¡Œé »ç‡..."></textarea>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-6">
                    <div>
                        <label class="block text-lg font-semibold mb-3" style="color: #DCC677">ğŸ‘¨â€ğŸ’¼ æŒ‡ç¤ºä¾†æº</label>
                        <input type="text" id="changeSource" class="form-input" placeholder="ä¾‹å¦‚ï¼šç¶“ç†ã€æ³•è¦..." />
                    </div>
                    <div>
                        <label class="block text-lg font-semibold mb-3" style="color: #DCC677">ğŸ¯ è®Šæ›´åŸå› </label>
                        <textarea id="changeReason" rows="4" class="form-input" placeholder="è¨˜éŒ„è®Šæ›´çš„åŸå› æˆ–èƒŒæ™¯..."></textarea>
                    </div>
                </div>

                <div>
                    <label class="block text-lg font-semibold mb-3" style="color: #DCC677">ğŸ“‹ äº¤æ¥æ³¨æ„äº‹é …</label>
                    <textarea id="handoverNotes" rows="3" class="form-input" placeholder="è¨˜éŒ„æœªä¾†äº¤æ¥æ™‚éœ€è¦ç‰¹åˆ¥æ³¨æ„çš„äº‹é …..."></textarea>
                </div>
                
                <div class="flex gap-6 pt-8">
                    <button onclick="saveChange()" class="btn-change">ğŸ’¾ å„²å­˜è®Šæ›´è¨˜éŒ„</button>
                    <button onclick="cancelChangeForm()" class="btn-cancel">âœ–ï¸ å–æ¶ˆ</button>
                </div>
            </div>
        </div>

        <!-- æ¨™ç±¤é  -->
        <div class="card">
            <div class="tab-container">
                <button class="tab-btn active" onclick="showTab('journal')">ğŸ“ å·¥ä½œæ—¥èªŒ</button>
                <button class="tab-btn" onclick="showTab('changes')">ğŸ”„ å·¥ä½œè®Šæ›´è¨˜éŒ„</button>
            </div>

            <!-- å·¥ä½œæ—¥èªŒå…§å®¹ -->
            <div id="journalTab" class="tab-content active">
                <div id="entriesList">
                    <div id="noEntries" class="text-center" style="padding: 4rem 0;">
                        <div style="font-size: 5rem; margin-bottom: 1.5rem; color: var(--pale-blue);">ğŸ“</div>
                        <p class="text-xl font-semibold" style="color: var(--deep-brown);">é–‹å§‹è¨˜éŒ„æ‚¨çš„å·¥ä½œæ—¥èªŒ</p>
                        <p style="color: var(--neutral-grey); margin-top: 0.5rem;">é»æ“Šä¸Šæ–¹ã€Œæ–°å¢æ—¥èªŒã€æŒ‰éˆ•é–‹å§‹è¨˜éŒ„</p>
                    </div>
                </div>
            </div>

            <!-- å·¥ä½œè®Šæ›´è¨˜éŒ„å…§å®¹ -->
            <div id="changesTab" class="tab-content">
                <div id="changesList">
                    <div id="noChanges" class="text-center" style="padding: 4rem 0;">
                        <div style="font-size: 5rem; margin-bottom: 1.5rem; color: #DCC677;">ğŸ”„</div>
                        <p class="text-xl font-semibold" style="color: #DCC677;">é–‹å§‹è¨˜éŒ„å·¥ä½œè®Šæ›´</p>
                        <p style="color: var(--neutral-grey); margin-top: 0.5rem;">é»æ“Šä¸Šæ–¹ã€Œå·¥ä½œè®Šæ›´ã€æŒ‰éˆ•é–‹å§‹è¨˜éŒ„</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- åˆªé™¤ç¢ºèªå½ˆçª— -->
    <div id="deleteModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-title">âš ï¸ ç¢ºèªåˆªé™¤</div>
            <div class="modal-message">ç¢ºå®šè¦åˆªé™¤é€™ç­†è¨˜éŒ„å—ï¼Ÿ<br>æ­¤æ“ä½œç„¡æ³•å¾©åŸã€‚</div>
            <div class="modal-buttons">
                <button id="confirmDelete" class="modal-btn modal-btn-confirm">ç¢ºå®šåˆªé™¤</button>
                <button id="cancelDelete" class="modal-btn modal-btn-cancel">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <!-- å¾…è¾¦äº‹é …å½ˆçª— -->
    <div id="todoModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <div style="font-size: 1.5rem; font-weight: bold; color: var(--deep-brown);">â˜ å¾…è¾¦äº‹é …</div>
                <button class="close-btn" onclick="hideTodoModal()">âœ–</button>
            </div>
            <div style="display: flex; gap: 0.5rem; margin-bottom: 2rem;">
                <input type="text" id="todoInput" style="flex: 1; padding: 0.75rem; border: 2px solid var(--secondary-mint); border-radius: 0.5rem; font-size: 1rem;" placeholder="æ–°å¢å¾…è¾¦äº‹é …..." onkeypress="handleTodoKeyPress(event)">
                <button onclick="addTodo()" style="background: var(--dusty-rose); color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 0.5rem; cursor: pointer; font-weight: 500;">æ–°å¢</button>
            </div>
            <div id="todoList"></div>
        </div>
    </div>

    <!-- çµ±è¨ˆå½ˆçª— -->
    <div id="statsModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h2 style="color: #AE78AB; font-size: 1.8rem; font-weight: bold; margin: 0;">ğŸ“Š æ•¸æ“šçµ±è¨ˆåˆ†æ</h2>
                <button class="close-btn" onclick="hideStatsModal()" style="color: #AE78AB;">âœ–</button>
            </div>
            <div id="statsContent">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                    <div style="background: linear-gradient(135deg, var(--pale-blue), var(--neutral-grey)); padding: 1.5rem; border-radius: 1rem; text-align: center; color: #666;">
                        <div id="totalEntries" style="font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem; color: #555;">0</div>
                        <div style="font-size: 0.9rem; opacity: 0.8; color: #777;">ç¸½æ—¥èªŒæ•¸</div>
                    </div>
                    <div style="background: linear-gradient(135deg, var(--pale-blue), var(--neutral-grey)); padding: 1.5rem; border-radius: 1rem; text-align: center; color: #666;">
                        <div id="totalChanges" style="font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem; color: #555;">0</div>
                        <div style="font-size: 0.9rem; opacity: 0.8; color: #777;">å·¥ä½œè®Šæ›´æ•¸</div>
                    </div>
                    <div style="background: linear-gradient(135deg, var(--pale-blue), var(--neutral-grey)); padding: 1.5rem; border-radius: 1rem; text-align: center; color: #666;">
                        <div id="thisMonthEntries" style="font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem; color: #555;">0</div>
                        <div style="font-size: 0.9rem; opacity: 0.8; color: #777;">æœ¬æœˆæ—¥èªŒ</div>
                    </div>
                    <div style="background: linear-gradient(135deg, var(--pale-blue), var(--neutral-grey)); padding: 1.5rem; border-radius: 1rem; text-align: center; color: #666;">
                        <div id="totalTodos" style="font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem; color: #555;">0</div>
                        <div style="font-size: 0.9rem; opacity: 0.8; color: #777;">å¾…è¾¦äº‹é …</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- åŒ¯å…¥è³‡æ–™å½ˆçª— -->
    <div id="importModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h2 style="color: var(--cool-sage); font-size: 1.8rem; font-weight: bold; margin: 0;">ğŸ“¥ åŒ¯å…¥è³‡æ–™</h2>
                <button class="close-btn" onclick="hideImportModal()" style="color: var(--cool-sage);">âœ–</button>
            </div>
            
            <div style="margin-bottom: 2rem;">
                <p style="color: #666; margin-bottom: 1rem;">é¸æ“‡è¦åŒ¯å…¥çš„æª”æ¡ˆé¡å‹ï¼š</p>
                
                <div style="display: grid; gap: 1rem; margin-bottom: 2rem;">
                    <div style="border: 2px dashed var(--cool-sage); border-radius: 0.5rem; padding: 2rem; text-align: center;">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ“Š</div>
                        <h3 style="color: var(--cool-sage); margin-bottom: 0.5rem;">Excel æª”æ¡ˆ</h3>
                        <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">åŒ¯å…¥ä¹‹å‰åŒ¯å‡ºçš„ Excel æª”æ¡ˆ</p>
                        <input type="file" id="excelFileInput" accept=".xlsx,.xls" style="display: none;" onchange="handleExcelImport(event)">
                        <button onclick="document.getElementById('excelFileInput').click()" style="background: var(--cool-sage); color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer;">é¸æ“‡ Excel æª”æ¡ˆ</button>
                    </div>
                    
                    <div style="border: 2px dashed var(--soft-brown); border-radius: 0.5rem; padding: 2rem; text-align: center;">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ“„</div>
                        <h3 style="color: var(--soft-brown); margin-bottom: 0.5rem;">JSON æª”æ¡ˆ</h3>
                        <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">åŒ¯å…¥å®Œæ•´å‚™ä»½æª”æ¡ˆï¼ˆæ¨è–¦ï¼‰</p>
                        <input type="file" id="jsonFileInput" accept=".json" style="display: none;" onchange="handleJsonImport(event)">
                        <button onclick="document.getElementById('jsonFileInput').click()" style="background: var(--soft-brown); color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer;">é¸æ“‡ JSON æª”æ¡ˆ</button>
                    </div>
                </div>
                
                <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 0.5rem; padding: 1rem;">
                    <h4 style="color: #856404; margin: 0 0 0.5rem 0;">âš ï¸ é‡è¦æé†’</h4>
                    <ul style="color: #856404; margin: 0; padding-left: 1.5rem; font-size: 0.9rem;">
                        <li>åŒ¯å…¥è³‡æ–™æœƒè¦†è“‹ç¾æœ‰çš„æ‰€æœ‰è¨˜éŒ„</li>
                        <li>å»ºè­°å…ˆåŒ¯å‡ºå‚™ä»½ç›®å‰çš„è³‡æ–™</li>
                        <li>JSON æ ¼å¼èƒ½å®Œæ•´ä¿ç•™æ‰€æœ‰è³‡æ–™çµæ§‹</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- æ€¥æ•‘ç®±è€—æç®¡ç†å½ˆçª— -->
    <div id="suppliesModal" class="modal-overlay hidden">
        <div class="modal-content" style="max-width: 800px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h2 style="color: #e74c3c; font-size: 1.8rem; font-weight: bold; margin: 0;">ğŸ¥ æ€¥æ•‘ç®±è€—æç®¡ç†</h2>
                <button class="close-btn" onclick="hideSuppliesModal()" style="color: #e74c3c;">âœ–</button>
            </div>
            
            <!-- æ–°å¢è€—æè¡¨å–® -->
            <div id="addSupplyForm" style="background: var(--pale-blue); border-radius: 0.75rem; padding: 1.5rem; margin-bottom: 2rem;">
                <h3 style="color: var(--deep-brown); margin-bottom: 1rem; font-weight: bold;">â• æ–°å¢/ç·¨è¼¯è€—æ</h3>
                <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                    <input type="text" id="supplyName" placeholder="è€—æåç¨±" class="form-input" style="padding: 0.5rem;">
                    <input type="number" id="supplyQuantity" placeholder="æ•¸é‡" class="form-input" style="padding: 0.5rem;" min="0">
                    <input type="number" id="supplyMinStock" placeholder="æœ€ä½åº«å­˜" class="form-input" style="padding: 0.5rem;" min="0">
                    <input type="date" id="supplyExpiry" class="form-input" style="padding: 0.5rem;">
                </div>
                <div style="display: flex; gap: 1rem;">
                    <button onclick="addSupply()" id="addSupplyBtn" style="background: #27ae60; color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer; font-weight: 500;">
                        â• æ–°å¢è€—æ
                    </button>
                    <button onclick="cancelSupplyEdit()" id="cancelSupplyBtn" style="background: var(--neutral-grey); color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer; font-weight: 500; display: none;">
                        âŒ å–æ¶ˆç·¨è¼¯
                    </button>
                </div>
            </div>

            <!-- è€—æåˆ—è¡¨ -->
            <div style="margin-bottom: 2rem;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h3 style="color: var(--deep-brown); font-weight: bold;">ğŸ“‹ è€—ææ¸…å–®</h3>
                    <div style="display: flex; gap: 0.5rem; align-items: center;">
                        <label style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.9rem;">
                            <input type="checkbox" id="selectAllSupplies" onchange="toggleSelectAll()" style="cursor: pointer;">
                            <span>å…¨é¸</span>
                        </label>
                        <button onclick="deleteSelectedSupplies()" id="deleteSelectedBtn" class="update-delete-btn" style="background: #e74c3c; color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer; font-size: 0.9rem; display: none;">
                            ğŸ—‘ï¸ åˆªé™¤é¸ä¸­
                        </button>
                        <select id="suppliesFilter" onchange="filterSupplies()" class="form-input" style="width: auto; padding: 0.5rem; font-size: 0.9rem;">
                            <option value="all">å…¨éƒ¨é¡¯ç¤º</option>
                            <option value="lowStock">åº«å­˜ä¸è¶³</option>
                            <option value="expired">å·²éæœŸ</option>
                            <option value="expiringSoon">å³å°‡éæœŸ</option>
                        </select>
                        <button onclick="exportSupplies()" style="background: var(--dusty-rose); color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer; font-size: 0.9rem;">
                            ğŸ“¤ åŒ¯å‡ºæ¸…å–®
                        </button>
                    </div>
                </div>
                
                <div id="suppliesList" style="max-height: 400px; overflow-y: auto;">
                    <!-- è€—æé …ç›®å°‡åœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ -->
                </div>
            </div>

            <!-- çµ±è¨ˆè³‡è¨Š -->
            <div style="background: var(--light-cream); border-radius: 0.75rem; padding: 1.5rem;">
                <h3 style="color: var(--deep-brown); margin-bottom: 1rem; font-weight: bold;">ğŸ“ˆ çµ±è¨ˆè³‡è¨Š</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">
                    <div style="text-align: center;">
                        <div id="totalSupplies" style="font-size: 1.5rem; font-weight: bold; color: #3498db;">0</div>
                        <div style="font-size: 0.9rem; color: #666;">ç¸½è€—æç¨®é¡</div>
                    </div>
                    <div style="text-align: center;">
                        <div id="lowStockCount" style="font-size: 1.5rem; font-weight: bold; color: #f39c12;">0</div>
                        <div style="font-size: 0.9rem; color: #666;">åº«å­˜ä¸è¶³</div>
                    </div>
                    <div style="text-align: center;">
                        <div id="expiredCount" style="font-size: 1.5rem; font-weight: bold; color: #e74c3c;">0</div>
                        <div style="font-size: 0.9rem; color: #666;">å·²éæœŸ</div>
                    </div>
                    <div style="text-align: center;">
                        <div id="expiringSoonCount" style="font-size: 1.5rem; font-weight: bold; color: #e67e22;">0</div>
                        <div style="font-size: 0.9rem; color: #666;">å³å°‡éæœŸ</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ç¯„æœ¬ç·¨è¼¯å™¨å½ˆè·³è¦–çª— -->
    <div id="templateEditor" class="modal-overlay hidden">
        <div class="modal-content" style="max-width: 800px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h2 style="color: #DCC677; font-size: 1.8rem; font-weight: bold; margin: 0;">âš™ï¸ ç¯„æœ¬ç·¨è¼¯å™¨</h2>
                <button class="close-btn" onclick="hideTemplateEditor()" style="color: #DCC677;">âœ–</button>
            </div>
            
            <div style="margin-bottom: 2rem;">
                <p style="color: #666; margin-bottom: 1rem;">æ‚¨å¯ä»¥è‡ªå®šç¾©å¿«é€Ÿç¯„æœ¬çš„å…§å®¹ï¼Œè®“æ—¥èªŒè¨˜éŒ„æ›´ç¬¦åˆæ‚¨çš„å·¥ä½œç¿’æ…£ã€‚</p>
            </div>
            
            <div style="display: grid; gap: 2rem;">
                <div>
                    <label style="display: block; font-weight: bold; margin-bottom: 0.5rem; color: var(--deep-brown);">ğŸ“‹ ç¯„æœ¬1</label>
                    <input type="text" id="routineName" class="form-input" placeholder="ç¯„æœ¬åç¨±..." style="margin-bottom: 0.5rem;">
                    <textarea id="routineTemplate" rows="4" class="form-input" placeholder="è¼¸å…¥ç¯„æœ¬å…§å®¹..."></textarea>
                </div>
                
                <div>
                    <label style="display: block; font-weight: bold; margin-bottom: 0.5rem; color: var(--deep-brown);">ğŸ¤ ç¯„æœ¬2</label>
                    <input type="text" id="meetingName" class="form-input" placeholder="ç¯„æœ¬åç¨±..." style="margin-bottom: 0.5rem;">
                    <textarea id="meetingTemplate" rows="4" class="form-input" placeholder="è¼¸å…¥ç¯„æœ¬å…§å®¹..."></textarea>
                </div>
                
                <div>
                    <label style="display: block; font-weight: bold; margin-bottom: 0.5rem; color: var(--deep-brown);">ğŸš¨ ç¯„æœ¬3</label>
                    <input type="text" id="emergencyName" class="form-input" placeholder="ç¯„æœ¬åç¨±..." style="margin-bottom: 0.5rem;">
                    <textarea id="emergencyTemplate" rows="4" class="form-input" placeholder="è¼¸å…¥ç¯„æœ¬å…§å®¹..."></textarea>
                </div>
                
                <div>
                    <label style="display: block; font-weight: bold; margin-bottom: 0.5rem; color: var(--deep-brown);">ğŸ’ª ç¯„æœ¬4</label>
                    <input type="text" id="healthName" class="form-input" placeholder="ç¯„æœ¬åç¨±..." style="margin-bottom: 0.5rem;">
                    <textarea id="healthTemplate" rows="4" class="form-input" placeholder="è¼¸å…¥ç¯„æœ¬å…§å®¹..."></textarea>
                </div>
                
                <div>
                    <label style="display: block; font-weight: bold; margin-bottom: 0.5rem; color: var(--deep-brown);">ğŸ“š ç¯„æœ¬5</label>
                    <input type="text" id="trainingName" class="form-input" placeholder="ç¯„æœ¬åç¨±..." style="margin-bottom: 0.5rem;">
                    <textarea id="trainingTemplate" rows="4" class="form-input" placeholder="è¼¸å…¥ç¯„æœ¬å…§å®¹..."></textarea>
                </div>
            </div>
            
            <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 2rem; padding-top: 2rem; border-top: 2px solid var(--pale-blue);">
                <button onclick="saveTemplates()" style="background: linear-gradient(135deg, #27ae60, #2ecc71); color: white; border: none; padding: 1rem 2rem; border-radius: 0.75rem; font-weight: bold; cursor: pointer; transition: all 0.3s ease;">
                    âœ… å„²å­˜ç¯„æœ¬
                </button>
                <button onclick="resetTemplates()" style="background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; border: none; padding: 1rem 2rem; border-radius: 0.75rem; font-weight: bold; cursor: pointer; transition: all 0.3s ease;">
                    ğŸ”„ é‡è¨­ç‚ºé è¨­
                </button>
                <button onclick="hideTemplateEditor()" style="background: var(--neutral-grey); color: white; border: none; padding: 1rem 2rem; border-radius: 0.75rem; font-weight: bold; cursor: pointer; transition: all 0.3s ease;">
                    âŒ å–æ¶ˆ
                </button>
            </div>
        </div>
    </div>

    <!-- å‚™ä»½è¨­å®šå½ˆè·³è¦–çª— -->
    <div id="backupSettingsModal" class="modal-overlay hidden">
        <div class="modal-content" style="max-width: 600px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h2 style="color: #8e44ad; font-size: 1.8rem; font-weight: bold; margin: 0;">ğŸ’¾ è‡ªå‹•å‚™ä»½è¨­å®š</h2>
                <button class="close-btn" onclick="hideBackupSettings()" style="color: #8e44ad;">âœ–</button>
            </div>
            
            <div style="margin-bottom: 2rem;">
                <div style="background: #e8f5e8; border: 1px solid #4caf50; border-radius: 0.5rem; padding: 1rem; margin-bottom: 1.5rem;">
                    <h4 style="color: #2e7d32; margin: 0 0 0.5rem 0;">ğŸ“Š å‚™ä»½ç‹€æ…‹</h4>
                    <div id="backupStatus" style="color: #2e7d32; font-size: 0.9rem;">
                        <p>ğŸ•’ ä¸Šæ¬¡å‚™ä»½ï¼š<span id="lastBackupTime">å¾æœªå‚™ä»½</span></p>
                        <p>ğŸ“ ç¸½è³‡æ–™é‡ï¼š<span id="dataCount">0</span> ç­†è¨˜éŒ„</p>
                        <p>âš¡ è‡ªå‹•å‚™ä»½ï¼š<span id="autoBackupStatus">å·²åœç”¨</span></p>
                    </div>
                </div>

                <div style="margin-bottom: 2rem;">
                    <h3 style="color: #8e44ad; margin-bottom: 1rem;">âš™ï¸ è‡ªå‹•å‚™ä»½è¨­å®š</h3>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                            <input type="checkbox" id="enableAutoBackup" onchange="toggleAutoBackup()" style="margin-right: 0.5rem;">
                            <span style="font-weight: bold;">å•Ÿç”¨è‡ªå‹•å‚™ä»½</span>
                        </label>
                    </div>

                    <div id="autoBackupOptions" style="display: none;">
                        <div style="margin-bottom: 1rem;">
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">å‚™ä»½é »ç‡ï¼š</label>
                            <select id="backupFrequency" class="form-input" onchange="updateBackupFrequency()">
                                <option value="daily">æ¯æ—¥å‚™ä»½</option>
                                <option value="weekly" selected>æ¯é€±å‚™ä»½</option>
                                <option value="biweekly">æ¯å…©é€±å‚™ä»½</option>
                                <option value="monthly">æ¯æœˆå‚™ä»½</option>
                            </select>
                        </div>

                        <div style="margin-bottom: 1rem;">
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">å‚™ä»½æ™‚æ©Ÿï¼š</label>
                            <select id="backupTrigger" class="form-input">
                                <option value="startup">ç³»çµ±å•Ÿå‹•æ™‚</option>
                                <option value="datachange" selected>è³‡æ–™è®Šæ›´æ™‚</option>
                                <option value="both">å•Ÿå‹•æ™‚ + è³‡æ–™è®Šæ›´æ™‚</option>
                            </select>
                        </div>

                        <div style="margin-bottom: 1rem;">
                            <label style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                                <input type="checkbox" id="keepBackupHistory" checked style="margin-right: 0.5rem;">
                                <span>ä¿ç•™å‚™ä»½æ­·å²ï¼ˆæœ€å¤š5å€‹æª”æ¡ˆï¼‰</span>
                            </label>
                        </div>
                    </div>
                </div>

                <div style="margin-bottom: 2rem;">
                    <h3 style="color: #8e44ad; margin-bottom: 1rem;">ğŸ”” å‚™ä»½æé†’</h3>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                            <input type="checkbox" id="enableBackupReminder" onchange="toggleBackupReminder()" style="margin-right: 0.5rem;">
                            <span style="font-weight: bold;">å•Ÿç”¨å‚™ä»½æé†’</span>
                        </label>
                    </div>

                    <div id="reminderOptions" style="display: none;">
                        <div style="margin-bottom: 1rem;">
                            <label style="display: block; margin-bottom: 0.5rem;">æé†’é »ç‡ï¼š</label>
                            <select id="reminderFrequency" class="form-input">
                                <option value="3">3å¤©æœªå‚™ä»½æ™‚æé†’</option>
                                <option value="7" selected>7å¤©æœªå‚™ä»½æ™‚æé†’</option>
                                <option value="14">14å¤©æœªå‚™ä»½æ™‚æé†’</option>
                                <option value="30">30å¤©æœªå‚™ä»½æ™‚æé†’</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div style="margin-bottom: 2rem;">
                    <h3 style="color: #8e44ad; margin-bottom: 1rem;">ğŸš€ ç«‹å³æ“ä½œ</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <button onclick="createManualBackup()" style="background: linear-gradient(135deg, #27ae60, #2ecc71); color: white; border: none; padding: 0.75rem; border-radius: 0.5rem; cursor: pointer; font-weight: bold;">
                            ğŸ’¾ ç«‹å³å‚™ä»½
                        </button>
                        <button onclick="testAutoBackup()" style="background: linear-gradient(135deg, #f39c12, #e67e22); color: white; border: none; padding: 0.75rem; border-radius: 0.5rem; cursor: pointer; font-weight